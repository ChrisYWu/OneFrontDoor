{"version":3,"file":"storereassign.component.js","sourceRoot":"","sources":["storereassign.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnInit, Input, Output, EventEmitter,ViewChild } from '@angular/core';\r\nimport {CORE_DIRECTIVES} from '@angular/common';\r\nimport {MODAL_DIRECTIVES, BS_VIEW_PROVIDERS, ModalDirective, DROPDOWN_DIRECTIVES} from 'ng2-bootstrap/ng2-bootstrap';\r\nimport {DispserviceService } from '../../services/dispservice.service';\r\nimport {Dispatches, Store, Route, ReassignStoreInput, DispatchOutput, RouteListExcludeCurrentInput} from '../../services/dispatch';\r\nimport {MerchConstant} from '../../../app/MerchAppConstant';\r\nimport {FilterPipe} from '../../pipes/filter.pipe';\r\n\r\n@Component({\r\n    moduleId: module.id,\r\n    selector: 'app-storereassign',\r\n    templateUrl: 'storereassign.component.html',\r\n    styleUrls: ['storereassign.component.css'],\r\n    directives: [MODAL_DIRECTIVES, DROPDOWN_DIRECTIVES, CORE_DIRECTIVES],\r\n    viewProviders: [BS_VIEW_PROVIDERS],\r\n    providers: [DispserviceService],\r\n    pipes: [FilterPipe]\r\n})\r\nexport class StorereassignComponent implements OnInit {\r\n    private _webapi: string = MerchConstant.WebAPI_ENDPOINT;\r\n    public routeId: number;\r\n    public routeName: string;\r\n    public gsn: string;\r\n    public reassignStore: ReassignStoreInput;\r\n    public resultInsert: DispatchOutput;\r\n    public routesFiltered: Array<Route> = [];\r\n    @ViewChild('lgModal') lgModal: ModalDirective;\r\n\r\n\r\n    @Input() lastModifiedByInput: string;\r\n    @Input() storeInput: Store;\r\n    @Input() routeData: Dispatches;\r\n    //@Input() routesInput: Array<Route> ;\r\n    @Input() routeNameInput: string;\r\n    @Output() routeReassigned = new EventEmitter();\r\n    @Output() merchReassigned = new EventEmitter();\r\n\r\n\r\n    constructor(public dispService: DispserviceService) {\r\n\r\n     }\r\n\r\n\r\n  \r\n    adjustSequence()\r\n    {\r\n        for(let i=0; i< this.routeData.Stores.length ; i++)\r\n        {\r\n            this.routeData.Stores[i].Sequence = i+1;\r\n        }\r\n    }\r\n\r\n  getRoutes(data: RouteListExcludeCurrentInput) {\r\n       \r\n        this.dispService.post(JSON.stringify(data))\r\n            .subscribe(res => {\r\n                var data: any = res;\r\n                this.routesFiltered = data.Routes;\r\n                this.lgModal.show();\r\n            },\r\n\r\n          \r\n            error => {\r\n\r\n                if (error.status == 401 || error.status == 404) {\r\n                    //this.notificationService.printErrorMessage('Authentication required');\r\n                    //this.utilityService.navigateToSignIn();\r\n                }\r\n            }\r\n            \r\n            );\r\n    }\r\n\r\n    setupdatedroute(routeid: number, routename: string, gsn:string) {\r\n\r\n        this.routeId = routeid;\r\n        this.routeName = routename;\r\n        this.gsn = gsn;\r\n\r\n\r\n        this.reassignStore = new ReassignStoreInput(this.routeData.DispatchDate,\r\n            this.storeInput.Sequence,\r\n            this.lastModifiedByInput,\r\n            this.routeData.MerchGroupID,\r\n            this.gsn,\r\n            this.routeId,\r\n            this.routeData.RouteID,\r\n            this.storeInput.AccountID);\r\n        \r\n        this.dispService.set(this._webapi + 'api/Merc/ReassignStore/');\r\n        \r\n        this.dispService.post(JSON.stringify(this.reassignStore))\r\n            .subscribe(res => {\r\n                var data: any = res;\r\n                this.resultInsert = data;\r\n                if (this.resultInsert.Message == null) {\r\n                    this.routeData.Stores.splice(this.storeInput.Sequence - 1, 1);\r\n                    this.adjustSequence();\r\n\r\n                    this.storeInput.PullNumber='';\r\n                    this.routeReassigned.emit(\r\n                        { routeid: this.routeId, store: this.storeInput}\r\n                    )\r\n\r\n                }\r\n                this.lgModal.hide();\r\n\r\n            },\r\n            error => {\r\n\r\n                if (error.status == 401 || error.status == 404) {\r\n                    //this.notificationService.printErrorMessage('Authentication required');\r\n                    //this.utilityService.navigateToSignIn();\r\n                }\r\n            });\r\n    }\r\n\r\n\r\n   \r\n\r\n    openModal()\r\n    {\r\n        this.dispService.set(this._webapi + 'api/Merc/GetRouteList/');\r\n        let routelistinput: RouteListExcludeCurrentInput;\r\n        routelistinput = new RouteListExcludeCurrentInput(this.routeData.DispatchDate, this.routeData.MerchGroupID, this.routeData.RouteID);\r\n        this.getRoutes(routelistinput)\r\n    }\r\n\r\n    ngOnInit() {\r\n      \r\n    }\r\n   \r\n\r\n}\r\n\r\n"]}