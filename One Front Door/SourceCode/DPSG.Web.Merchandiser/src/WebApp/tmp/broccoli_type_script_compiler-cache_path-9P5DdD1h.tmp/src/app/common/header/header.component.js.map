{"version":3,"file":"header.component.js","sourceRoot":"","sources":["header.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnInit, ElementRef } from '@angular/core';\nimport { Http, Headers, Response, RequestOptions } from '@angular/http';\nimport { ROUTER_DIRECTIVES } from '@angular/router';\nimport { DROPDOWN_DIRECTIVES } from 'ng2-bootstrap/ng2-bootstrap';\nimport {LocalStorageService} from 'ng2-webstorage';\nimport {Idle, DEFAULT_INTERRUPTSOURCES} from 'ng2-idle/core';\nimport {MerchConstant} from '../../../app/MerchAppConstant';\nimport {MerchBranch, MerchGroup} from '../../services/planning';\nimport {HeadernavService} from '../../services/headernav.service';\nimport {Subscription} from 'rxjs/Subscription';\n\n// import { TopMenuComponent }   from '../menu/top-menu';\n// import { TopSubMenuComponent }   from '../menu/top-sub-menu';\n// import { UserDropdownComponent }   from '../menu/user-dropdown';\n\n@Component({\n  moduleId: module.id,\n  selector: 'app-header',\n  templateUrl: 'header.component.html',\n  styleUrls: ['header.component.css'],\n  directives: [ROUTER_DIRECTIVES, DROPDOWN_DIRECTIVES],\n  providers: [HeadernavService]\n})\nexport class HeaderComponent implements OnInit {\n\nprivate _webapi: string = MerchConstant.WebAPI_ENDPOINT;\npublic userName:string;\npublic merchBranches:Array<MerchBranch>;\npublic merchGroups:Array<MerchGroup>=[];\npublic merchTargetGroups:Array<MerchGroup>;\npublic nobranch:boolean=false;\npublic nomerchgroup:boolean=false;\npublic selectedBranchID : string;\n\npublic menushowreport:boolean=false;\npublic menushowplanning:boolean=false;\npublic selectedBranch:MerchBranch;\npublic selectedGroup:MerchGroup;\npublic item : MerchGroup= new MerchGroup();\npublic merchitem : MerchGroup= new MerchGroup();\n subscription:Subscription;\npublic isGeoVisible: boolean = true;\n\n\npublic disabled:boolean = false;\n  public status:{isopen:boolean} = {isopen: false};\n  public items:Array<string> = ['The first choice!',\n    'And another choice for you.', 'but wait! A third!'];\n \n  public toggled(open:boolean):void {\n    console.log('Dropdown is now: ', open);\n  }\n \n  public toggleDropdown($event:MouseEvent):void {\n    $event.preventDefault();\n    $event.stopPropagation();\n    this.status.isopen = !this.status.isopen;\n  }\n\n\n  constructor(public http: Http, public localSt: LocalStorageService, public idle: Idle,private navService: HeadernavService) {\n        idle.setIdle(1200);\n    idle.setTimeout(5);\n    idle.setInterrupts(DEFAULT_INTERRUPTSOURCES);\n\n\n    idle.onTimeout.subscribe(() => {\n      console.log('Timeout');\n      window.location.href = \"/logout.html\";\n    });\n\n   idle.watch();\n  }\n\n  ngOnInit() {\n    \n      this.selectedBranch = new MerchBranch();\n      this.selectedGroup = new MerchGroup();\n      this.checkUserAuth();\n\n\n       this.subscription =  this.navService.navMerchItem$.subscribe(newitem => {this.merchitem = newitem; this.addMerchItem(newitem); });\n  }\n\n  addMerchItem(merchitem)\n  {\n    this.merchitem = merchitem;\n    if(this.merchitem.MerchGroupID!= undefined)\n    {\n      this.merchGroups.push(this.merchitem);\n      this.filterMerchGroups(merchitem.SAPBranchID);\n    }\n\n    \n  }\n\n hideGeo(flag: number)\n {\n   if (flag == 1)\n    this.isGeoVisible = false;\n  else\n    this.isGeoVisible = true;\n }\n\n  onBranchSelect(branch)\n  {\n    this.selectedBranch = branch;\n    this.filterMerchGroups(branch.SAPBranchID);\n    this.selectedGroup.LoggedInUser = this.localSt.retrieve(\"UserGSN\");\n    this.navService.changeNav(this.selectedGroup);  \n  }\n  onGroupSelect(group)\n  {\n    this.selectedGroup = group;\n    this.item = this.selectedGroup;\n    this.item.LoggedInUser = this.localSt.retrieve(\"UserGSN\");\n     this.navService.changeNav(this.item);      \n  }\n\n  filterMerchGroups(sapBranchID:string)\n  {\n       this.merchTargetGroups = this.merchGroups.filter((d:any) =>\n                    {\n                        if(d.SAPBranchID == sapBranchID)\n                        return d;\n                    });\n                     var grp = this.merchTargetGroups.filter((d:any) =>\n                    {\n                        if(d.IsDefault == true)\n                        return d;\n                    });\n\n                   if(this.merchTargetGroups.length==0)\n                   {\n                        this.merchTargetGroups = [];\n                        this.selectedGroup.SAPBranchID = sapBranchID;\n                        this.selectedGroup.GroupName = '';\n                        this.selectedGroup.MerchGroupID = null;\n                   }\n                   else if(grp.length==0)\n                    {\n                     this.selectedGroup = this.merchTargetGroups[0];\n                    }\n                    else\n                    {\n                       this.selectedGroup = grp[0];\n                    }\n                    \n  }\n\ncheckUserAuth(): void {\n        this.WebAPIPostCall().subscribe(res => {\n                var d: any = res;\n                if (d.UserInfo.IsValid == 1)\n                {\n                  this.localSt.store('UserGSN', d.UserInfo.GSN);\n                  this.localSt.store('UserName', d.UserInfo.Name);\n                  this.localSt.store('UserEmail', d.UserInfo.Email);  \n                  this.userName = d.UserInfo.Name;\n                  if(d.Branches.length>=0)\n                  {\n                    \n\n                    var brch = d.Branches.filter((d:any) =>\n                    {\n                        if(d.IsDefault == true)\n                        return d;\n                    });\n\n                    if(brch.length==0)\n                    {\n                       this.selectedBranch = d.Branches[0];\n                    }\n                    else\n                    {\n                       this.selectedBranch = brch[0];\n                    }\n                    this.merchBranches = d.Branches;\n                    this.nobranch = true;\n                  }\n\n\n                \n\n                  if(d.Groups.length >= 0)\n                  {\n                    \n                     this.merchGroups = d.Groups;\n                     this.merchTargetGroups = Object.assign(this.merchGroups);\n\n                     this.filterMerchGroups(this.selectedBranch.SAPBranchID);                        \n                    \n                    this.nomerchgroup = true;\n                  }\n\n                    console.log(this.localSt.retrieve('UserGSN'));\n                    console.log(this.localSt.retrieve('UserName'));\n                    console.log(this.localSt.retrieve('UserEmail'));\n                }\n                else{\n                    console.log(\"User is not valid\");\n                }\n\n                 this.item = this.selectedGroup;\n                 this.item.LoggedInUser = this.localSt.retrieve(\"UserGSN\");\n                 this.navService.changeNav(this.item); \n\n               \n            },\n            error => {\n                if (error.status == 401 || error.status == 404) {\n                }\n            });  \n       }\n\n  WebAPIPostCall()\n      {\n        return this.http.get(this._webapi + 'api/Merc/CheckAuthenticationByUser/')\n                      .map(response => <any>(<Response>response).json());\n      }\n}\n"]}