{"version":3,"file":"route-item.component.js","sourceRoot":"","sources":["route-item.component.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  Component,\n  OnInit,\n  Input,\n  Output,\n  EventEmitter\n} from '@angular/core';\nimport {\n  CORE_DIRECTIVES\n} from '@angular/common';\nimport {\n  MODAL_DIRECTIVES,\n  BS_VIEW_PROVIDERS\n} from 'ng2-bootstrap/ng2-bootstrap';\nimport {\n  MonitorPopupComponent\n} from '../monitor-popup'\nimport {\n  MonitorService\n} from '../../services/monitor.service'\n\nimport {\n  ImageURLInput\n} from '../../reporting/storeservice/MerchReport';\nimport {\n  MerchConstant\n} from '../../../app/MerchAppConstant';\nimport {\n  DispserviceService\n} from '../../services/dispservice.service';\n\n@Component({\n  moduleId: module.id,\n  selector: 'route-item',\n  templateUrl: 'route-item.component.html',\n  styleUrls: ['route-item.component.css'],\n  directives: [MODAL_DIRECTIVES, CORE_DIRECTIVES, MonitorPopupComponent],\n  viewProviders: [BS_VIEW_PROVIDERS],\n  providers: [MonitorService, DispserviceService]\n})\nexport class RouteItemComponent implements OnInit {\n\n  @Input() stop: any;\n  @Input() idx: number;\n  @Input() count: number;\n\n  public storeDetails: any = {\n    CheckInTime: \" \",\n    CheckOutTime: \" \",\n    UserMileage: 0,\n    AtAccountTimeInMinute: 0,\n    TimeInStore: \" \",\n    CasesHandeled: 0,\n    CaessInBackroom: 0,\n    Comments: \" \"\n  };\n\n  public storePictures: any[] = [];\n\n  public displayPictures: any[] = [];\n\n  public storeSignature = {\n    ManagerName: \"Name not available\",\n    SignatureName: \"\",\n    ClientTime: \"\",\n    ClientTimeZone: \"\",\n    RelativeURL: \"\",\n    AbsoluteURL: \"\",\n    StorageAccount: \"\",\n    Container: \"\",\n    AccessLevel: \"\",\n    ConnectionString: \"\",\n    azureImageURL: \"\"\n  }\n\n\n  private mydayWebAPI: string = MerchConstant.MYDAY_WebAPI_ENDPOINT;\n\n  constructor(\n    private monitorService: MonitorService,\n    private dispService: DispserviceService\n  ) {\n\n  }\n\n  seprateStoreCode(): void {\n    if (this.stop != null) {\n      let _accountName = this.stop.AccountName;\n      let _lastIndex = _accountName.lastIndexOf(\" \");\n      let _length = _accountName.length;\n      let _accName = _accountName.substring(0, _lastIndex);\n      let _accNo = _accountName.substring(_lastIndex, _length);\n      this.stop.accName = _accName.trim();\n      this.stop.accNo = _accNo.trim();\n    }\n\n  }\n\n  showPopup(storeModal, stopMerchStopID): void {\n\n    debugger\n\n\n    if (stopMerchStopID > 0) {\n\n   let isStoreSignature = false;\n   let isStorePictures = false;\n\n      this.monitorService.getStoreDetailsData(stopMerchStopID)\n        .subscribe(res => {\n            var data: any = res.json();\n            this.storeDetails = data.Details[0];\n            if (data.StoreSignature[0] != null || data.StoreSignature[0] != undefined) {\n              this.storeSignature = data.StoreSignature[0];\n              if (this.storeSignature != null) {\n               isStoreSignature =  this.getStoreSignaturePicture(this.storeSignature);\n              }\n            }else\n            {\n              isStoreSignature = true; \n            }\n\n            if (data.StorePictures != null || data.StorePictures != undefined) {\n              let _sps = data.StorePictures;\n              if (_sps.length > 0) {\n               isStorePictures =  this.getStorePictures(_sps);\n              }else\n              {\n                isStorePictures = true; \n              }\n            }else\n            {\n              isStorePictures = true; \n            }\n\n      \n\n            //here to add display pictures -- this.displayPictures = this.getDisplayPictures();  \n            \n            //below change implement latter on, once all senario check at local data, currently no data for all senarios \n            //  if(isStoreSignature && isStorePictures )\n            //  {\n             //   storeModal.show();\n            //  }\n\n            storeModal.show();\n            \n          },\n          error => {\n            if (error.status == 401 || error.status == 404) {\n              //this.notificationService.printErrorMessage('Authentication required');\n              //this.utilityService.navigateToSignIn();\n            }\n          });\n\n    }\n  }\n\n/*\n  getDisplayPictures() {\n    let _excPictures: any = []\n\n    _excPictures\n      = [{\n          'ImageURL': 'contents/img/store3.PNG',\n          'Name': '2016 Dr Pepper Event',\n\n        }, {\n          'ImageURL': 'contents/img/nostoreimage.PNG',\n          'Name': '2016 Dr. Pepper Celebration No Time',\n\n        }, {\n          'ImageURL': 'contents/img/nostoreimage.PNG',\n          'Name': '2016 Canada Dry Celebration No Time',\n\n        },\n\n        {\n          'ImageURL': 'contents/img/nostoreimage.PNG',\n          'Name': '2016 Dr. Pepper Celebration No Time 2',\n\n        }, {\n          'ImageURL': 'contents/img/nostoreimage.PNG',\n          'Name': '2016 Canada Dry Celebration No Time 2',\n\n        },\n      ]\n\n    return _excPictures;\n  }\n  */\n\n  getStopCSS(stop: any): string {\n    //[class]=\"stop.ConnectorType == 'Solid'? 'stop-circle circle-green' : 'stop-circle circle-gray'\"\n    let css = \"stop-circle circle-gray-fill\"\n    if (stop.ConnectorType.toLowerCase() == 'solid') {\n      if (stop.DisplayBuildStatus.toLowerCase() == \"not done\") {\n        css = \"stop-circle circle-red-fill\";\n      } else {\n        css = \"stop-circle circle-green-fill\";\n      }\n    } else {\n      css = \"stop-circle circle-gray-fill\";\n    }\n\n    return css;\n  }\n\n  getStoreSignaturePicture(storeSignature) {\n\n    let isDone = false;\n\n    this.dispService.set(this.mydayWebAPI + 'MerchWebAPI/api/Imaging/GetReadOnlyImageURL');\n    this.storeSignature.azureImageURL = \"\";\n\n    let imgURLInput = new ImageURLInput(\n      storeSignature.RelativeURL,\n      storeSignature.AbsoluteURL,\n      storeSignature.Container,\n      storeSignature.StorageAccount,\n      storeSignature.AccessLevel,\n      storeSignature.ConnectionString\n    );\n\n\n    this.dispService.post(JSON.stringify(imgURLInput), true)\n      .subscribe(res => {\n          //  debugger;\n          isDone = true ;        \n          var d: any = res;\n          this.storeSignature.azureImageURL = d.Response;\n        },\n        error => {\n\n          if (error.status == 401 || error.status == 404) {}\n        });\n\n        return isDone ;\n  }\n\n  getStorePictures(storePics) {\n\n   let isDone = false;\n\n    this.storePictures = [];\n\n    this.dispService.set(this.mydayWebAPI + 'MerchWebAPI/api/Imaging/GetReadOnlyImageURL');\n\n    for (let i = 0; i < storePics.length; i++) {\n\n      let imgURLInput = new ImageURLInput(\n        storePics[i].RelativeURL,\n        storePics[i].AbsoluteURL,\n        storePics[i].Container,\n        storePics[i].StorageAccount,\n        storePics[i].AccessLevel,\n        storePics[i].ConnectionString\n      );\n\n\n      this.dispService.post(JSON.stringify(imgURLInput), true)\n        .subscribe(res => {\n            //debugger;\n            isDone = true;\n            var d: any = res;\n            this.storePictures.push({\n              'ImageURL': d.Response,\n              'Name': storePics[i].Caption\n            })\n\n          },\n          error => {\n\n            if (error.status == 401 || error.status == 404) {}\n          });\n\n   return isDone; \n\n    }\n\n  }\n\n  getImageURL(inputdata: ImageURLInput): string {\n\n    //  debugger;\n\n    let azureImgURL: string = \"\";\n    this.dispService.set(this.mydayWebAPI + 'MerchWebAPI/api/Imaging/GetReadOnlyImageURL');\n    this.dispService.post(JSON.stringify(inputdata), true)\n      .subscribe(res => {\n\n          //  debugger;\n          var d: any = res;\n          // Add image URL in imageList\n          azureImgURL = d.Response;\n\n        },\n        error => {\n          //   debugger;\n          if (error.status == 401 || error.status == 404) {}\n        });\n\n    return azureImgURL;\n  }\n\n  ngOnInit() {\n    this.seprateStoreCode();\n  }\n\n}\n"]}