{"version":3,"file":"route.component.js","sourceRoot":"","sources":["route.component.ts"],"names":[],"mappings":"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","sourcesContent":["\r\nimport { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\r\nimport {CORE_DIRECTIVES} from '@angular/common';\r\n\r\nimport {DND_PROVIDERS, DND_DIRECTIVES } from 'ng2-dnd/ng2-dnd';\r\nimport { DispserviceService } from '../../services/dispservice.service';\r\nimport {Account, StorePreDispatch, DispatchOutput, Store, Dispatches, ResequenceInput, RemoveStoreinput, Route, Merchandiser} from '../../services/dispatch';\r\nimport {AddstoreComponent} from '../addstore/';\r\nimport {StorereassignComponent} from '../storereassign/';\r\nimport {MerchreassignComponent} from '../merchreassign/';\r\nimport {MerchConstant} from '../../../app/MerchAppConstant';\r\nimport { SpinnerComponent } from '../../common/spinner';\r\n\r\n\r\n@Component({\r\n    moduleId: module.id,\r\n    selector: 'app-route',\r\n    templateUrl: 'route.component.html',\r\n    styleUrls: ['route.component.css'],\r\n    directives: [CORE_DIRECTIVES, AddstoreComponent, DND_DIRECTIVES, StorereassignComponent, MerchreassignComponent, SpinnerComponent],\r\n    providers: [DispserviceService, DND_PROVIDERS]\r\n\r\n})\r\n\r\nexport class RouteComponent implements OnInit {\r\n\r\n    private _webapi: string = MerchConstant.WebAPI_ENDPOINT;\r\n    //public selectedacct: number;\r\n\r\n    @Input() selectedacct: Store;\r\n    @Input() routeName: String;\r\n    public resultInsert: DispatchOutput;\r\n    public storePredispatchInsertData: StorePreDispatch;\r\n    public isRequesting: boolean;\r\n\r\n    @Input() unassignedInputAccts: Array<Account>;\r\n    @Input() allInputAccts: Array<Account>;\r\n    @Input() otherInputAccts: Array<Account>;\r\n    @Input() dispatchDateInput: Date;\r\n    @Input() lastModifiedByInput: string;\r\n    @Input() routeData: Dispatches;\r\n    @Input() routeIdInput: number;\r\n    //@Input() routesInput: Array<Route>;\r\n    @Input() unassignedOtherMerchInput: Array<Merchandiser>;\r\n    @Input() unassignedMerchInput: Array<Merchandiser>;\r\n\r\n    @Output() routeReassigned = new EventEmitter();\r\n    @Output() accountSelected = new EventEmitter();\r\n    \r\n\r\n\r\n\r\n    constructor(public dispService: DispserviceService) { }\r\n\r\n\r\n    private stopRefreshing() {\r\n        this.isRequesting = false;\r\n    }\r\n\r\n    setselectedAcct($event) {\r\n\r\n        this.accountSelected.emit(\r\n            { $event }\r\n        )\r\n    }\r\n\r\n    draggedSuccess(seq: number) {\r\n\r\n    }\r\n\r\n    setupdatedroute($event) {\r\n\r\n        this.routeReassigned.emit({\r\n            value: $event\r\n        });\r\n\r\n    }\r\n\r\n\r\n\r\n    dropStore(moveFrom) {\r\n        let moveTo: number;\r\n\r\n        for (var i = 0; i < this.routeData.Stores.length; i++) {\r\n            if (moveFrom == this.routeData.Stores[i].Sequence) {\r\n                moveTo = i + 1;\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < this.routeData.Stores.length; i++) {\r\n            if (i + 1 != this.routeData.Stores[i].Sequence) {\r\n                this.routeData.Stores[i].Sequence = i + 1;\r\n            }\r\n        }\r\n\r\n        this.dispService.set(this._webapi + 'api/Merc/UpdateSequence/');\r\n        let resequenceInput: ResequenceInput;\r\n\r\n        resequenceInput = new ResequenceInput(this.dispatchDateInput, this.routeData.RouteID, moveFrom, moveTo, this.lastModifiedByInput);\r\n        this.updateSequence(resequenceInput);\r\n        \r\n    }\r\n\r\n    pullInfoUpdate() {\r\n\r\n\r\n        let tempStores: Array<Store> = this.routeData.Stores.slice();\r\n\r\n        for (var j = 0; j < tempStores.length; j++) {\r\n            let pullcount = 0;\r\n            for (var k = 0; k < this.routeData.Stores.length; k++) {\r\n                if (tempStores[j].AccountID == this.routeData.Stores[k].AccountID) {\r\n                    pullcount++;\r\n                    if (pullcount == 1) {\r\n                        this.routeData.Stores[k].PullNumber = \"\";\r\n                    }\r\n                    else if (pullcount == 2) {\r\n                        this.routeData.Stores[k].PullNumber = pullcount + \"nd Pull\";\r\n                    }\r\n                    else if (pullcount == 3) {\r\n                        this.routeData.Stores[k].PullNumber = pullcount + \"rd Pull\";\r\n                    }\r\n                    else {\r\n                        this.routeData.Stores[k].PullNumber = pullcount + \"th Pull\";\r\n                    }\r\n\r\n                }\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    removeStore(sequence) {\r\n        this.dispService.set(this._webapi + 'api/Merc/RemoveStore/');\r\n        let removeStoreInput: RemoveStoreinput;\r\n        removeStoreInput = new RemoveStoreinput(this.dispatchDateInput, this.routeData.RouteID, sequence, this.lastModifiedByInput);\r\n        this.dispService.post(JSON.stringify(removeStoreInput))\r\n            .subscribe(res => {\r\n                var data: any = res;\r\n                this.resultInsert = data;\r\n                if (this.resultInsert.Message == null) {\r\n                    this.routeData.Stores.splice(sequence - 1, 1);\r\n                    for (var i = sequence - 1; i < this.routeData.Stores.length; i++) {\r\n                        this.routeData.Stores[i].Sequence = this.routeData.Stores[i].Sequence - 1;\r\n                    }\r\n                 \r\n                    this.pullInfoUpdate();\r\n                    this.accountSelected.emit({});\r\n                }\r\n\r\n            },\r\n            error => {\r\n\r\n                if (error.status == 401 || error.status == 404) {\r\n                    //this.notificationService.printErrorMessage('Authentication required');\r\n                    //this.utilityService.navigateToSignIn();\r\n                }\r\n            });\r\n    }\r\n\r\n    updateSequence(resequenceInput: ResequenceInput) {\r\n        this.isRequesting = true;\r\n        this.dispService.post(JSON.stringify(resequenceInput))\r\n            .subscribe(res => {\r\n                var data: any = res;\r\n                this.resultInsert = data;\r\n                if (this.resultInsert.Message == null) {\r\n                    this.pullInfoUpdate();\r\n                }\r\n                //if (this.resultInsert.Result == \"1\") {\r\n                //    this.accountSelected.emit(\r\n                //        { value: \"refresh\" }\r\n                //    )\r\n                //}\r\n\r\n\r\n            },\r\n            () => this.stopRefreshing(),\r\n            () => this.stopRefreshing()\r\n            // error => {\r\n\r\n            //     if (error.status == 401 || error.status == 404) {\r\n            //         //this.notificationService.printErrorMessage('Authentication required');\r\n            //         //this.utilityService.navigateToSignIn();\r\n            //     }\r\n            //}\r\n            );\r\n    }\r\n\r\n\r\n\r\n    ngOnInit() {\r\n\r\n    }\r\n\r\n}\r\n"]}